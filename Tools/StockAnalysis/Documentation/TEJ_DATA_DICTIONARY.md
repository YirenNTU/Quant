# 📚 TEJ API 資料字典 (Data Dictionary)

**版本**: 1.0  
**更新日期**: 2026-01-30  
**API Key**: E-SHOP 初入江湖版  

---

## 📋 目錄

1. [資料表總覽](#資料表總覽)
2. [TWN/APIPRCD - 股價資料](#twnapiprcd---股價資料)
3. [TWN/AINVFINB - 財務報表](#twnainvfinb---財務報表)
4. [TWN/APISALE - 月營收](#twnapisale---月營收)
5. [TWN/APISTOCK - 證券屬性](#twnapistock---證券屬性)
6. [TWN/APISHRACT - 籌碼資料](#twnapishract---籌碼資料)
7. [TWN/APIDV1 - 股利資料](#twnapidv1---股利資料)
8. [TWN/APISTK1 - 資本形成](#twnapistk1---資本形成)
9. [TWN/AFESTM1 - 自結數](#twnafestm1---自結數)
10. [API 使用範例](#api-使用範例)
11. [策略應用對照表](#策略應用對照表)

---

## 資料表總覽

| # | 資料表 ID | 名稱 | 欄位數 | 更新頻率 | 主要用途 |
|---|-----------|------|--------|----------|----------|
| 1 | `TWN/APIPRCD` | 股價資料 | 29 | 每日 | 價量分析、估值 |
| 2 | `TWN/AINVFINB` | 財務報表 | 94 | 每季 | 財務分析、基本面 |
| 3 | `TWN/APISALE` | 月營收 | 23 | 每月10日 | 營收動能、即時監控 |
| 4 | `TWN/APISTOCK` | 證券屬性 | 16 | 不定期 | 產業分類、公司資料 |
| 5 | `TWN/APISHRACT` | 籌碼資料 | 62 | 每日 | 法人動向、融資融券 |
| 6 | `TWN/APIDV1` | 股利資料 | 20 | 不定期 | 股利政策、殖利率 |
| 7 | `TWN/APISTK1` | 資本形成 | 75 | 不定期 | 增減資、股本變動 |
| 8 | `TWN/AFESTM1` | 自結數 | 27 | 每月 | 初步財務、提前預警 |

---

## TWN/APIPRCD - 股價資料

**說明**: 每日股價、成交量、估值比率  
**更新頻率**: 每日收盤後  
**欄位數**: 29  

### 欄位清單

| 欄位名稱 | 資料類型 | 說明 | 範例值 | 策略用途 |
|----------|----------|------|--------|----------|
| `coid` | string | 股票代碼 | 2330 | 主鍵 |
| `mdate` | datetime | 交易日期 | 2026-01-29 | 時間索引 |
| `mkt` | string | 市場別 | TWSE | 上市/上櫃 |
| `open_d` | float | **開盤價** | 1830.0 | K線 |
| `high_d` | float | **最高價** | 1835.0 | K線 |
| `low_d` | float | **最低價** | 1800.0 | K線 |
| `close_d` | float | **收盤價** | 1805.0 | K線、均線 |
| `adjfac` | float | 調整因子 | 1.0 | 還原價計算 |
| `vol` | int | **成交量 (張)** | 36079 | 🔥流動性過濾 |
| `amt` | int | 成交金額 | 65452000580 | 成交值 |
| `trn` | int | 成交筆數 | 112652 | 散戶參與度 |
| `bid` | float | 買進價 | 1805.0 | 買賣價差 |
| `offer` | float | 賣出價 | 1810.0 | 買賣價差 |
| `avgprc` | float | 均價 | 1814.11 | 成本估算 |
| `roi` | float | **當日報酬率 (%)** | -0.8242 | 動能計算 |
| `hmlpct` | float | 振幅 (%) | 1.9231 | 波動度 |
| `turnover` | float | **週轉率 (%)** | 0.1391 | 🔥流動性指標 |
| `shares` | int | 流通股數 | 25932525 | 股本 |
| `mktcap` | int | **市值** | 46808206760000 | 🔥規模過濾、估值 |
| `mktcap_pct` | float | 市值佔比 (%) | 44.2378 | 大盤權重 |
| `amt_pct` | float | 成交佔比 (%) | 7.314 | 市場熱度 |
| `per` | float | **本益比 (PE)** | 29.5 | ✅估值分析 |
| `pbr` | float | **股價淨值比 (PB)** | 9.36 | ✅估值分析 |
| `div_yid` | float | **殖利率 (%)** | 0.94 | 💰股利策略 |
| `cdiv_yid` | float | 現金殖利率 (%) | 1.1219 | 股利策略 |
| `adjfac_a` | float | 年度調整因子 | 1.0 | 還原價 |
| `per_tej` | float | PE (TEJ算法) | 29.4214 | 估值 |
| `pbr_tej` | float | PB (TEJ算法) | 9.3648 | 估值 |
| `psr_tej` | float | **PSR (股價營收比)** | 12.8898 | 🔥成長股估值 |

### 使用範例

```python
import tejapi
tejapi.ApiConfig.api_key = "YOUR_API_KEY"

# 抓取最近一年股價
data = tejapi.get(
    'TWN/APIPRCD',
    coid='2330',
    mdate={'gte': '2025-01-01', 'lte': '2026-01-30'},
    opts={'sort': 'mdate.asc'},
    paginate=True
)
```

---

## TWN/AINVFINB - 財務報表

**說明**: 會計師簽證財務資料 (83個科目)  
**更新頻率**: 每季 (財報公布後)  
**欄位數**: 94  

### 基本欄位

| 欄位名稱 | 說明 | 範例值 |
|----------|------|--------|
| `coid` | 股票代碼 | 2330 |
| `mdate` | 財報截止日 | 2025-09-01 |
| `no` | 報表類型 | TTM / Q1 / Q2 / Q3 / Q4 |
| `sem` | 季度 | 3 |
| `curr` | 幣別 | NTD |
| `merg` | 是否合併報表 | Y |
| `begd` | 期間起始日 | 2024-10-01 |
| `endd` | 期間結束日 | 2025-09-30 |

### 資產負債表科目

| 欄位名稱 | 說明 | 單位 | 策略用途 |
|----------|------|------|----------|
| `a0100` | 流動資產 | 千元 | 流動性 |
| `a0960` | 非流動資產 | 千元 | 長期資產 |
| `a0010` | **資產總額** | 千元 | 🔥ROA分母 |
| `a1100` | 流動負債 | 千元 | 短期償債 |
| `a1800` | 非流動負債 | 千元 | 長期負債 |
| `a1000` | **負債總額** | 千元 | 槓桿分析 |
| `a200e` | 歸屬母公司權益 | 千元 | ROE分母 |
| `a2000` | **權益總額** | 千元 | 淨值 |
| `a211f` | **應收帳款** | 千元 | 🔥DSO計算 |
| `a2111` | 流通在外股數 | 千股 | EPS計算 |

### 損益表科目

| 欄位名稱 | 說明 | 單位 | 策略用途 |
|----------|------|------|----------|
| `a3100` | **營業收入** | 千元 | 🔥GPM/OPM分母 |
| `a3200` | **營業成本** | 千元 | 毛利計算 |
| `a3295` | **毛利** | 千元 | GPM分子 |
| `a3300` | 營業費用 | 千元 | 費用分析 |
| `a3395` | 營業淨利 | 千元 | 核心獲利 |
| `a3501` | **營業利益** | 千元 | 🔥OPM分子 |
| `a3700` | 營業外收支 | 千元 | 業外品質 |
| `a3900` | 稅前淨利 | 千元 | 稅前獲利 |
| `a2402` | **稅後淨利** | 千元 | 🔥EPS/ROE |
| `a2403` | 本期綜合損益 | 千元 | 綜合損益 |

### 現金流量表科目

| 欄位名稱 | 說明 | 單位 | 策略用途 |
|----------|------|------|----------|
| `a7210` | **營業活動現金流** | 千元 | 🔥FCF/Sloan |
| `a7300` | **投資活動現金流** | 千元 | CAPEX估算 |
| `a7400` | **籌資活動現金流** | 千元 | 財務策略 |

### 財務比率 (已計算好!) 🔥

| 欄位名稱 | 說明 | 範例值 | 策略用途 |
|----------|------|--------|----------|
| `r101` | **ROE (%)** | 23.44 | 🔥獲利能力 |
| `r103` | **ROA (%)** | 34.99 | 🔥資產效率 |
| `r105` | **毛利率 GPM (%)** | 58.98 | ✅核心指標 |
| `r106` | **營益率 OPM (%)** | 49.48 | ✅核心指標 |
| `r107` | 稅前淨利率 (%) | 52.27 | 獲利品質 |
| `r108` | 稅後淨利率 (%) | 43.63 | 獲利品質 |
| `r112` | 業外比重 (%) | 2.79 | 🔥雜訊過濾 |
| `r201` | 負債比率 (%) | 9.47 | 槓桿 |
| `r401` | **營收成長率 YoY (%)** | 36.96 | 🔥成長動能 |
| `r402` | 營業利益成長率 (%) | 48.34 | 獲利成長 |
| `r403` | 稅前淨利成長率 (%) | 55.37 | 獲利成長 |
| `r501` | **EPS** | 269.3 | 每股盈餘 |
| `r502` | 每股淨值 | 239.75 | 帳面價值 |
| `r509` | 現金流量比率 (%) | 19.75 | 現金充裕度 |

### 使用範例

```python
# 抓取最近8季財報
data = tejapi.get(
    'TWN/AINVFINB',
    coid='2330',
    opts={'limit': 8, 'sort': 'mdate.desc'},
    paginate=True
)

# 直接使用內建比率
gpm = data['r105'].iloc[0]  # 毛利率
opm = data['r106'].iloc[0]  # 營益率
roe = data['r101'].iloc[0]  # ROE
```

---

## TWN/APISALE - 月營收

**說明**: 每月營業收入  
**更新頻率**: 每月10日前公布上月營收  
**欄位數**: 23  
**優勢**: 比季報早2個月，最即時的基本面數據！  

### 欄位清單

| 欄位名稱 | 說明 | 範例值 | 策略用途 |
|----------|------|--------|----------|
| `coid` | 股票代碼 | 2330 | 主鍵 |
| `mdate` | 營收月份 | 2025-12-01 | 時間索引 |
| `annd_s` | 公告日期 | 2026-01-09 | 資訊時效 |
| `d0001` | **當月營收** (千元) | 335003568 | 🔥即時營收 |
| `d0002` | 去年同月營收 | 278163107 | YoY基準 |
| `d0003` | **月營收 YoY (%)** | 20.43 | 🔥成長動能 |
| `d0004` | **月營收 MoM (%)** | -2.51 | 環比變化 |
| `d0005` | **累計營收** (YTD) | 3809054272 | 年度進度 |
| `d0006` | 去年累計營收 | 2894307699 | YoY基準 |
| `d0007` | 累計營收 YoY (%) | 31.61 | 年度成長 |
| `r18` | 累計營收成長率 (%) | 31.61 | 年度成長 |
| `r19` | 月均營收 | 146.88 | 平均水準 |
| `d0025` | 流通股數 (千股) | 25932525 | 股本 |
| `d0026` | 每股營收 | 12.92 | PSR計算 |

### 使用範例

```python
# 抓取最近12個月營收
data = tejapi.get(
    'TWN/APISALE',
    coid='2330',
    opts={'limit': 12, 'sort': 'mdate.desc'},
    paginate=True
)

# 計算營收加速度
yoy_latest = data['d0003'].iloc[0]   # 最新月YoY
yoy_prev = data['d0003'].iloc[1]     # 上月YoY
acceleration = yoy_latest - yoy_prev  # 營收加速度
```

---

## TWN/APISTOCK - 證券屬性

**說明**: 公司基本資料與產業分類  
**更新頻率**: 不定期  
**欄位數**: 16  

### 欄位清單

| 欄位名稱 | 說明 | 範例值 | 策略用途 |
|----------|------|--------|----------|
| `coid` | 股票代碼 | 2330 | 主鍵 |
| `mdate` | 資料日期 | 2026-01-01 | 版本 |
| `stk_name` | **股票簡稱** | 台積電 | 顯示名稱 |
| `stk_f_chi` | 公司全名 (中文) | 台灣積體電路製造 | 完整名稱 |
| `enm` | 英文簡稱 | TSMC | 國際名稱 |
| `stk_eng` | 公司全名 (英文) | Taiwan Semiconductor... | 英文名稱 |
| `ind_ban` | 統一編號 | 22099131 | 公司ID |
| `list_date` | **上市日期** | 1994-09-05 | 公司歷史 |
| `tse_date` | 證交所日期 | 1994-09-05 | 上市日 |
| `otc_date` | 櫃買日期 | NaN | 上櫃日 |
| `delist_date` | 下市日期 | NaN | 下市警示 |
| `main_ind_c` | **主產業 (中文)** | M2300 電子工業 | 🔥產業分類 |
| `main_ind_e` | 主產業 (英文) | M2300 Electronics | 產業分類 |
| `sub_ind_c` | **次產業 (中文)** | M2324 半導體業 | 🔥細分產業 |
| `sub_ind_e` | 次產業 (英文) | M2324 Semiconductor | 細分產業 |

### 產業代碼對照

| 代碼 | 產業名稱 | 對應 ETF |
|------|----------|----------|
| M2300 | 電子工業 | 0050.TW |
| M2324 | 半導體業 | 0050.TW |
| M2325 | 電腦及週邊 | 0050.TW |
| M2326 | 光電業 | 0050.TW |
| M2327 | 通信網路業 | 0050.TW |
| M1700 | 金融保險業 | 0055.TW |
| M2100 | 食品工業 | 0056.TW |

---

## TWN/APISHRACT - 籌碼資料

**說明**: 三大法人買賣超、融資融券  
**更新頻率**: 每日收盤後  
**欄位數**: 62  
**優勢**: 追蹤「聰明錢」動向！  

### 三大法人

| 欄位名稱 | 說明 | 範例值 | 策略用途 |
|----------|------|--------|----------|
| `qfii_buy` | **外資買進 (張)** | 18215 | 法人動向 |
| `qfii_sell` | **外資賣出 (張)** | 26844 | 法人動向 |
| `qfii_ex` | **外資買賣超** | -8629 | 🔥法人態度 |
| `qfii_pct` | **外資持股比例 (%)** | 72.29 | 🔥籌碼集中度 |
| `fund_buy` | 投信買進 (張) | 732 | 投信動向 |
| `fund_sell` | 投信賣出 (張) | 717 | 投信動向 |
| `fund_ex` | **投信買賣超** | 15 | 🔥投信認同 |
| `fd_pct` | 投信持股比例 (%) | 2.65 | 籌碼分析 |
| `dlrp_ex` | 自營商(自行)買賣超 | -88 | 自營動向 |
| `dlrh_ex` | 自營商(避險)買賣超 | 368 | 避險需求 |
| `dlr_pct` | 自營商持股比例 (%) | 0.15 | 籌碼分析 |
| `tot_buy` | 三大法人合計買 | 19918 | 法人買進 |
| `tot_sell` | 三大法人合計賣 | 28253 | 法人賣出 |
| `tot_ex` | **三大法人合計買賣超** | -8334 | 🔥總體法人 |

### 融資融券

| 欄位名稱 | 說明 | 範例值 | 策略用途 |
|----------|------|--------|----------|
| `buy_l` | 融資買進 | 873 | 散戶情緒 |
| `sell_l` | 融資賣出 | 543 | 散戶情緒 |
| `long_t` | **融資餘額 (張)** | 19907 | 🔥散戶持倉 |
| `buy_s` | 融券賣出 | 23 | 放空力道 |
| `sell_s` | 融券買進 | 20 | 回補需求 |
| `short_t` | **融券餘額 (張)** | 343 | 放空部位 |
| `s_l_pct` | **券資比 (%)** | 1.72 | 🔥軋空指標 |

### 當沖

| 欄位名稱 | 說明 | 範例值 | 策略用途 |
|----------|------|--------|----------|
| `vol_dt` | 當沖量 (張) | 7188 | 短線熱度 |
| `vol_dtp` | 當沖比例 (%) | 19.92 | 投機程度 |

### 使用範例

```python
# 抓取最近30天籌碼資料
data = tejapi.get(
    'TWN/APISHRACT',
    coid='2330',
    mdate={'gte': '2025-12-01', 'lte': '2026-01-30'},
    opts={'sort': 'mdate.desc'},
    paginate=True
)

# 計算法人連續買超天數
consecutive_buy = (data['tot_ex'] > 0).astype(int)
```

---

## TWN/APIDV1 - 股利資料

**說明**: 股利公告與發放資料  
**更新頻率**: 股利公告後  
**欄位數**: 20  

### 主要欄位

| 欄位名稱 | 說明 | 範例值 |
|----------|------|--------|
| `coid` | 股票代碼 | 2330 |
| `mdate` | 公告日期 | 2025-11-11 |
| `distri_end` | 盈餘分配期間終止 | 2025-09-30 |
| `distri_type` | 分配類型 | Q3 (季配) |
| `edexdate` | 除息日 | 2026-03-17 |

---

## TWN/APISTK1 - 資本形成

**說明**: 股本變動、增減資紀錄  
**更新頻率**: 事件發生後  
**欄位數**: 75  

### 主要用途

- 偵測增資稀釋風險
- 追蹤股本變動歷史
- 計算調整後股數

---

## TWN/AFESTM1 - 自結數

**說明**: 公司自行公布的初步財務數據 (17個科目)  
**更新頻率**: 每月15日前公布上月  
**欄位數**: 27  
**優勢**: 比正式財報早1-2週！  

### 主要欄位

| 欄位名稱 | 說明 | 範例值 | 策略用途 |
|----------|------|--------|----------|
| `ip12` | 累計營收 | 3809053851 | 營收追蹤 |
| `opi` | 累計營業利益 | 1936091677 | 獲利追蹤 |
| `isibt` | 累計稅前淨利 | 2041662840 | 獲利品質 |
| `isnip` | 累計稅後淨利 | 1717878637 | EPS預估 |
| `eps` | 累計 EPS | 66.25 | 🔥提前預警 |
| `r106` | 營益率 (%) | 50.83 | 獲利能力 |
| `r401` | 營收成長率 (%) | 31.61 | 成長動能 |

---

## API 使用範例

### 基本連線

```python
import tejapi
import pandas as pd

# 設定 API Key
tejapi.ApiConfig.api_key = "YOUR_API_KEY"
tejapi.ApiConfig.ignoretz = True

# 基本查詢
data = tejapi.get(
    'TWN/APIPRCD',           # 資料表名稱
    coid='2330',             # 股票代碼
    mdate={'gte': '2025-01-01', 'lte': '2025-12-31'},  # 日期範圍
    opts={'sort': 'mdate.asc', 'limit': 100},          # 排序與限制
    paginate=True            # 自動分頁 (重要!)
)
```

### 批次查詢多支股票

```python
tickers = ['2330', '2317', '2454']
all_data = []

for ticker in tickers:
    data = tejapi.get(
        'TWN/APIPRCD',
        coid=ticker,
        mdate={'gte': '2025-01-01'},
        paginate=True
    )
    all_data.append(data)

combined = pd.concat(all_data, ignore_index=True)
```

### 欄位篩選

```python
# 只抓特定欄位
data = tejapi.get(
    'TWN/AINVFINB',
    coid='2330',
    columns=['coid', 'mdate', 'r105', 'r106', 'r101'],  # GPM, OPM, ROE
    opts={'limit': 8, 'sort': 'mdate.desc'},
    paginate=True
)
```

---

## 策略應用對照表

### 現有策略模組 → TEJ 欄位對應

| 策略模組 | 需要的指標 | TEJ 欄位 | 來源表 |
|----------|------------|----------|--------|
| **pool_analyser** | GPM | `r105` | AINVFINB |
| | OPM | `r106` | AINVFINB |
| | GPM Slope | `r105` (多季計算) | AINVFINB |
| | OPM Slope | `r106` (多季計算) | AINVFINB |
| | 業外比重 | `r112` | AINVFINB |
| **health_checker** | OCF | `a7210` | AINVFINB |
| | Net Income | `a2402` | AINVFINB |
| | Inventory | (需確認欄位) | AINVFINB |
| | DSO | `a211f` / `a3100` | AINVFINB |
| **valuation_analyzer** | PE | `per` | APIPRCD |
| | PB | `pbr` | APIPRCD |
| | Price | `close_d` | APIPRCD |
| | Sector | `main_ind_c` | APISTOCK |
| **forensic_analyzer** | Net Income | `a2402` | AINVFINB |
| | OCF | `a7210` | AINVFINB |
| | ICF | `a7300` | AINVFINB |
| | Total Assets | `a0010` | AINVFINB |
| | ROA | `r103` | AINVFINB |
| **shadow_gem_detector** | Revenue YoY | `d0003` 🔥 | APISALE |
| | RS | `close_d` (計算) | APIPRCD |
| | PSR | `psr_tej` | APIPRCD |
| | Market Cap | `mktcap` 🔥 | APIPRCD |

### 新增建議指標

| 新指標 | 用途 | TEJ 欄位 | 來源表 |
|--------|------|----------|--------|
| 外資買賣超 | 法人認同 | `qfii_ex` | APISHRACT |
| 投信買賣超 | 法人認同 | `fund_ex` | APISHRACT |
| 外資持股比 | 籌碼集中度 | `qfii_pct` | APISHRACT |
| 融資增減 | 散戶情緒 | `long_t` | APISHRACT |
| 券資比 | 軋空指標 | `s_l_pct` | APISHRACT |
| 月營收YoY | 即時動能 | `d0003` | APISALE |
| 自結EPS | 提前預警 | `eps` | AFESTM1 |
| 殖利率 | 價值投資 | `div_yid` | APIPRCD |
| 週轉率 | 流動性 | `turnover` | APIPRCD |

---

## 附錄：API 限制

| 項目 | 限制 |
|------|------|
| 每日呼叫次數 | 1000 次 |
| 每日資料筆數 | 1000 萬筆 |
| 單次查詢上限 | 無限制 (使用 paginate=True) |

---

*文件由 Investment AI 系統自動生成*  
*如有問題請聯繫 TEJ 客服或查閱官方文件*

